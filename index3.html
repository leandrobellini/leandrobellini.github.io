<html>
  <head>  
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> 
		<script src="https://js.hcaptcha.com/1/api.js?hl=pt&?onload=checkVisitor&render=explicit" async defer></script>
    <script>
      var setHCField = function (response) {
        // your code can go here if updating state in your app.
        window.havePasscode = true;
        // `response` will be a text string containing the passcode
        window.curPasscode = response;
      };
      var setExpired = function () {
        // set status for your app state tracking code (example)
        window.havePasscode = false;
        // get a new passcode.
        // no need to specify the widgetID if only one on a page.
        hcaptcha.execute();
      };
      var checkVisitor = function () {
        // inject an element to use for our IFRAME
        g = document.createElement('div');
        document.body.appendChild(g);
        // instantiate the hCaptcha widget
        var _widgetID = hcaptcha.render(g, {
          size: 'invisible',
          sitekey: 'eb1af52d-327c-4e3d-bd79-99a2cbc65ba6',
          callback: setHCField,
          'expired-callback': setExpired,
        });
        // get a passcode
        hcaptcha.execute(_widgetID);
        // hcaptcha.execute();
      };
    </script>
  </head>

  <body>
    <form id="login-form" class="form" method="POST">
      <h3 class="text-center text-info">Login</h3>
      <div class="form-group">
        <label for="cpf" class="text-info">CPF:</label><br>
        <input type="text" name="cpf" id="cpf" class="form-control" minlength="11" maxlength="11">
      </div>
      <div class="form-group">
        <label for="senha" class="text-info">Senha:</label><br>
        <input type="password" name="senha" id="senha" class="form-control"  maxlength="6">
      </div>					
      <br>

      <div class="form-group">
      <!--
        <div id="hcaptcha" class="h-captcha" data-sitekey="eb1af52d-327c-4e3d-bd79-99a2cbc65ba6" data-callback="onSubmit" data-size="invisible"></div>
        <div id="hcaptcha" class="h-captcha" data-sitekey="eb1af52d-327c-4e3d-bd79-99a2cbc65ba6" data-callback="SendForm()" data-theme="dark"></div>
        <input type="submit" name="submit" class="btn btn-info btn-md" value="submit" id="submit" onclick="hcaptcha.execute()">
      -->
      <!-- data-size="invisible" -->
      <div id="hcaptcha" class="h-captcha" data-sitekey="eb1af52d-327c-4e3d-bd79-99a2cbc65ba6" data-callback="setHCField()" data-theme="dark"></div>
        <input type="submit" name="submit" class="btn btn-info btn-md" value="submit" id="submit" />
        <!--
          <button id="submit" class="btn btn-info btn-md" onclick="SendForm()">submit</button>
          <button id="hcaptcha" class="h-captcha" data-sitekey="eb1af52d-327c-4e3d-bd79-99a2cbc65ba6" data-callback="onSubmit">Submit</button>
        -->
      </div>
      <h6 id="login-sucess" style="color:green" >Login realizado com sucesso!</h6>
      <h6 id="login-error" style="color:red">Usuário e senha inválidos!</h6>
    </form>
  </body>
  #28
</html>

<script>
  alert('bc');
	checkVisitor();
  alert('ac');

	// function SendForm(token) {
	// 	alert('A');
	// 	hcaptcha.execute();
	// 	alert('B');
	// 	document.getElementById('login-form').submit();
	// 	alert('C');
    // }

    $('#login-sucess').css('visibility', 'hidden');
    $('#login-error').css('visibility', 'hidden');	

    $( "#login-form" ).submit(function( event ) {
	
      $('#login-sucess').css('visibility', 'hidden');
      $('#login-error').css('visibility', 'hidden');

      alert('1');
		
      // Get form
      var form = $('#login-form')[0];
      var data = new FormData(form);

      var object = {};
      data.forEach(function(value, key){
        object[key] = value;
      });
      
      var json = JSON.stringify(object);

      event.preventDefault();
      var form = $(this);
      // var actionUrl = form.attr('action');

      actionUrl = "https://poc-login.azurewebsites.net/api/HttpTrigger3?code=5x4fgjsZVv5LWZ4UXMG4A2RtYPaGKsiuQWdKaxaNIeIAAzFuycYW2g=="

      var dados = {
        cpf: $("#cpf").val(),
        senha: $("#senha").val(),
        hcaptcha: $("#hcaptcha").val()
        gcaptcha: $("#gcaptcha").val()
      }

      $.ajax({
        type: "POST",
        url: actionUrl,
        data: json,
        success: function(data)
        {
            console.log(data)
            $("#login-sucess").css('visibility', 'visible');
        },
        error: function (data) {
            console.log(data)
            $("#login-error").css('visibility', 'visible');
        },
      });

		  alert('2');

    });	
</script>